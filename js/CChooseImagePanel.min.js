function CChooseImagePanel(){var e,t,i,o,_,s,r,n,a,l,S,h;this._init=function(){t=0,S=new createjs.Container,s_oStage.addChild(S);var r=createBitmap(s_oSpriteLibrary.getSprite("bg_menu"));S.addChild(r);var A=s_oSpriteLibrary.getSprite("top_orientation");_pStartPosSnickers={x:CANVAS_WIDTH/2-A.width,y:A.height/9},(n=createBitmap(A)).x=_pStartPosSnickers.x,n.y=_pStartPosSnickers.y,s_oStage.addChild(n);A=s_oSpriteLibrary.getSprite("extra_logo");_pStartPosExtra={x:_pStartPosSnickers.x+A.width/2+120,y:_pStartPosSnickers.y},(a=createBitmap(A)).x=_pStartPosExtra.x,a.y=_pStartPosExtra.y;A=s_oSpriteLibrary.getSprite("but_exit");if(o={x:CANVAS_WIDTH-A.width/2-10,y:A.height/2+50},(l=new CGfxButton(o.x,o.y,A,S)).addEventListener(ON_MOUSE_UP,this._onExit,this),e=A.height,!1===DISABLE_SOUND_MOBILE||!1===s_bMobile){A=s_oSpriteLibrary.getSprite("audio_icon");_={x:CANVAS_WIDTH-A.width/4-10,y:l.getY()+A.height+10},(h=new CToggle(_.x,_.y,A,s_bAudioActive,S)).addEventListener(ON_MOUSE_UP,this._onAudioToggle,this)}this._checkBoundLimits(),i=new Array;for(var E=CANVAS_WIDTH-2*EDGEBOARD_X-160,g=Math.floor(E/NUM_COLS_PAGE_LEVEL)/2,u=0,L=0;L<NUM_COLS_PAGE_LEVEL;L++)i.push(u),u+=2*g;if(s=new Array,this._createNewLevelPage(0,NUM_IMAGES),s.length>1){for(var d=1;d<s.length;d++)s[d].visible=!1;new CGfxButton(CANVAS_WIDTH/2+670,CANVAS_HEIGHT/2+30,s_oSpriteLibrary.getSprite("arrow_right"),S).addEventListener(ON_MOUSE_UP,this._onRight,this),new CGfxButton(CANVAS_WIDTH/2-670,CANVAS_HEIGHT/2+30,s_oSpriteLibrary.getSprite("arrow_left"),S).addEventListener(ON_MOUSE_UP,this._onLeft,this)}this.refreshButtonPos(s_iOffsetX,s_iOffsetY)},this.unload=function(){l.unload(),s_oStage.removeAllChildren(),s_oChooseImagePanel=null},this.refreshButtonPos=function(e,t){l.setPosition(o.x-e,o.y+t),!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||h.setPosition(_.x-e,t+_.y),n.x=_pStartPosSnickers.x+e,n.y=_pStartPosSnickers.y+t,a.x=_pStartPosExtra.x+e,a.y=_pStartPosExtra.y+t},this.resetFullscreenBut=function(){null},this._checkBoundLimits=function(){for(var t=s_oSpriteLibrary.getSprite("but_level_"+LANGUAGES[CURRENT_LANGUAGE]),i=0,o=CANVAS_HEIGHT-2*EDGEBOARD_Y-2*e,_=0;i<o;)i+=t.height+20,_++;NUM_ROWS_PAGE_LEVEL>_&&(NUM_ROWS_PAGE_LEVEL=_);var s=0,r=0,n=CANVAS_WIDTH-2*EDGEBOARD_X;for(t=s_oSpriteLibrary.getSprite("but_level_"+LANGUAGES[CURRENT_LANGUAGE]);r<n;)r+=t.width/2+5,s++;NUM_COLS_PAGE_LEVEL>s&&(NUM_COLS_PAGE_LEVEL=s)},this._createNewLevelPage=function(e,t){var o=new createjs.Container;S.addChild(o),s.push(o),r=new Array;for(var _=0,n=0,a=1,l=!1,h=e;h<t;h++){var A=s_oSpriteLibrary.getSprite("image_"+(h+1)+"-"+LANGUAGES[CURRENT_LANGUAGE]);console.log("langue: ","image_"+(h+1)+"-"+LANGUAGES[CURRENT_LANGUAGE]);var E=new CButLevel(i[_],n,A,"image_"+(h+1)+"-"+LANGUAGES[CURRENT_LANGUAGE],o);if(E.addEventListenerWithParams(ON_MOUSE_UP,this._onButLevelRelease,this,"image_"+(h+1)+"-"+LANGUAGES[CURRENT_LANGUAGE]),r.push(E),++_===i.length&&h<t-1&&(_=0,n+=A.height+20,++a>NUM_ROWS_PAGE_LEVEL)){l=!0;break}}o.x=CANVAS_WIDTH/2,o.y=CANVAS_HEIGHT/2+30,o.regX=o.getBounds().width/2,o.regY=o.getBounds().height/2,l&&this._createNewLevelPage(h+1,t)},this._onButLevelRelease=function(e){s_oChooseImagePanel.unload(),s_szImageSelected=e,console.log("Image selected: "+s_szImageSelected),s_oMain.gotoChooseDifficulty()},this._onRight=function(){s[t].visible=!1,++t>=s.length&&(t=0),s[t].visible=!0},this._onLeft=function(){s[t].visible=!1,--t<0&&(t=s.length-1),s[t].visible=!0},this._onAudioToggle=function(){Howler.mute(s_bAudioActive),s_bAudioActive=!s_bAudioActive},this._onFullscreenRelease=function(){s_bFullscreen?null.call(window.document):null.call(window.document.documentElement),sizeHandler()},this._onExit=function(){s_oChooseImagePanel.unload(),s_oMain.gotoMenu()},s_oChooseImagePanel=this,this._init()}var s_oChooseImagePanel=null;