function CChooseImagePanel(){var e,t,i,o,s,_,r,n,a,l,h,S;this._init=function(){t=0,h=new createjs.Container,s_oStage.addChild(h);var r=createBitmap(s_oSpriteLibrary.getSprite("bg_menu"));h.addChild(r);var g=s_oSpriteLibrary.getSprite("snickers_logo");_pStartPosSnickers={x:g.height/2+10,y:g.height/2},(n=createBitmap(g)).x=_pStartPosSnickers.x,n.y=_pStartPosSnickers.y,s_oStage.addChild(n);g=s_oSpriteLibrary.getSprite("extra_logo");_pStartPosExtra={x:_pStartPosSnickers.x+g.width/2+120,y:_pStartPosSnickers.y},(a=createBitmap(g)).x=_pStartPosExtra.x,a.y=_pStartPosExtra.y,s_oStage.addChild(a);g=s_oSpriteLibrary.getSprite("but_exit");if(o={x:CANVAS_WIDTH-g.width/2-10,y:g.height/2+50},(l=new CGfxButton(o.x,o.y,g,h)).addEventListener(ON_MOUSE_UP,this._onExit,this),e=g.height,!1===DISABLE_SOUND_MOBILE||!1===s_bMobile){g=s_oSpriteLibrary.getSprite("audio_icon");s={x:CANVAS_WIDTH-g.width/4-10,y:l.getY()+g.height+10},(S=new CToggle(s.x,s.y,g,s_bAudioActive,h)).addEventListener(ON_MOUSE_UP,this._onAudioToggle,this)}this._checkBoundLimits(),i=new Array;for(var E=CANVAS_WIDTH-2*EDGEBOARD_X-160,A=Math.floor(E/NUM_COLS_PAGE_LEVEL)/2,u=0,d=0;d<NUM_COLS_PAGE_LEVEL;d++)i.push(u),u+=2*A;if(_=new Array,this._createNewLevelPage(0,NUM_IMAGES),_.length>1){for(var L=1;L<_.length;L++)_[L].visible=!1;new CGfxButton(CANVAS_WIDTH/2+670,CANVAS_HEIGHT/2+30,s_oSpriteLibrary.getSprite("arrow_right"),h).addEventListener(ON_MOUSE_UP,this._onRight,this),new CGfxButton(CANVAS_WIDTH/2-670,CANVAS_HEIGHT/2+30,s_oSpriteLibrary.getSprite("arrow_left"),h).addEventListener(ON_MOUSE_UP,this._onLeft,this)}this.refreshButtonPos(s_iOffsetX,s_iOffsetY)},this.unload=function(){l.unload(),s_oStage.removeAllChildren(),s_oChooseImagePanel=null},this.refreshButtonPos=function(e,t){l.setPosition(o.x-e,o.y+t),!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||S.setPosition(s.x-e,t+s.y),n.x=_pStartPosSnickers.x+e,n.y=_pStartPosSnickers.y+t,a.x=_pStartPosExtra.x+e,a.y=_pStartPosExtra.y+t},this.resetFullscreenBut=function(){null},this._checkBoundLimits=function(){for(var t=s_oSpriteLibrary.getSprite("but_level_"+LANGUAGES[CURRENT_LANGUAGE]),i=0,o=CANVAS_HEIGHT-2*EDGEBOARD_Y-2*e,s=0;i<o;)i+=t.height+20,s++;NUM_ROWS_PAGE_LEVEL>s&&(NUM_ROWS_PAGE_LEVEL=s);var _=0,r=0,n=CANVAS_WIDTH-2*EDGEBOARD_X;for(t=s_oSpriteLibrary.getSprite("but_level_"+LANGUAGES[CURRENT_LANGUAGE]);r<n;)r+=t.width/2+5,_++;NUM_COLS_PAGE_LEVEL>_&&(NUM_COLS_PAGE_LEVEL=_)},this._createNewLevelPage=function(e,t){var o=new createjs.Container;h.addChild(o),_.push(o),r=new Array;for(var s=0,n=0,a=1,l=!1,S=e;S<t;S++){var g=s_oSpriteLibrary.getSprite("image_"+(S+1));console.log("langue: "+LANGUAGES[CURRENT_LANGUAGE]);var E=new CButLevel(i[s],n,g,"image_"+(S+1),o);if(E.addEventListenerWithParams(ON_MOUSE_UP,this._onButLevelRelease,this,"image_"+(S+1)),r.push(E),++s===i.length&&S<t-1&&(s=0,n+=g.height+20,++a>NUM_ROWS_PAGE_LEVEL)){l=!0;break}}o.x=CANVAS_WIDTH/2,o.y=CANVAS_HEIGHT/2+30,o.regX=o.getBounds().width/2,o.regY=o.getBounds().height/2,l&&this._createNewLevelPage(S+1,t)},this._onButLevelRelease=function(e){s_oChooseImagePanel.unload(),s_szImageSelected=e,console.log("Image selected: "+s_szImageSelected),s_oMain.gotoChooseDifficulty()},this._onRight=function(){_[t].visible=!1,++t>=_.length&&(t=0),_[t].visible=!0},this._onLeft=function(){_[t].visible=!1,--t<0&&(t=_.length-1),_[t].visible=!0},this._onAudioToggle=function(){Howler.mute(s_bAudioActive),s_bAudioActive=!s_bAudioActive},this._onFullscreenRelease=function(){s_bFullscreen?null.call(window.document):null.call(window.document.documentElement),sizeHandler()},this._onExit=function(){s_oChooseImagePanel.unload(),s_oMain.gotoMenu()},s_oChooseImagePanel=this,this._init()}var s_oChooseImagePanel=null;